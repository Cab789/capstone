<template>
  <li class="result">
    <div class="result-title row">
      <div class="col-md-9">

        <a target="_blank" class="simple"
           :href="result.frontend_url">
          {{result.name_abbreviation}}
        </a>
      </div>
      <div v-if="result.decision_date"
           class="col-md-3 decision-date">
        {{ formatDate(result.decision_date) }}
      </div>
    </div>
    <div class="row metadata-row">
      <span v-for="(citation, index) in result.citations"
            v-bind:key="citation.cite"
            class="result-citation">
        {{ citation.cite }}<span v-if="index+1 < result.citations.length">, </span>
      </span>
      <span class="court"
            v-if="result.court">
      &nbsp;&middot;
          {{ result.court.name }}
      </span>
      <span class="jurisdiction">
        &nbsp;&middot;
          {{result.jurisdiction.name_long}}
      </span>
    </div>
    <div class="row" v-if="result.preview.length > 0">
      <span class="previews">
        <span class="preview_set_elipsis"> ... </span><span
            v-for="(preview, index) in result.preview" v-bind:key="index" class="preview" v-html="preview"></span><br>
      </span>
    </div>
  </li>
</template>

<script>
  export default {
    props: [
      'result'
    ],
    methods: {
      formatDate(dateStr) {
        /*
          Format a date string of any precision:
            1999-02-10 becomes February 10, 1999
            1999-02    becomes February 1999
            1999       becomes 1999
        */
        const patch = '0000-01-01';
        const patchedDateStr = dateStr + patch.slice(dateStr.length);
        const parsedDate = new Date(patchedDateStr);
        const formatOptions = {timeZone: "UTC", year: "numeric"};
        if (dateStr.length > 4)
          formatOptions.month = "long";
        if (dateStr.length > 7)
          formatOptions.day = "numeric";
        return parsedDate.toLocaleDateString(undefined, formatOptions);
      }
    }
  }
</script>