import{_ as m}from"./_commonjsHelpers.9baf49e8.js";import{n as p,V as a}from"./vueComponentNormalizer.bf45ea69.js";import{V as h}from"./vue-router.esm.636d16a2.js";import{s as f}from"./sync.94c5b92d.js";import{j as _}from"./api.b6932234.js";import{U as g}from"./usa_territories_white.c3990beb.js";import"./utils.814d5bc1.js";import"./jquery.9c517ada.js";var b=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",[e("div",[e("h2",[t._v("Map view")]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-3 col-md-12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"hoveredJurSelect"}},[t._v("Selected jurisdiction:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.hoveredJur,expression:"hoveredJur"}],staticClass:"form-control",attrs:{id:"hoveredJurSelect"},on:{change:function(i){var n=Array.prototype.filter.call(i.target.options,function(s){return s.selected}).map(function(s){var r="_value"in s?s._value:s.value;return r});t.hoveredJur=i.target.multiple?n:n[0]}}},[e("option",{attrs:{disabled:"",value:""}},[t._v("Select one, or hover on the map")]),t._l(t.jurisdictions,function(i){return e("option",{key:i.id,domProps:{value:i}},[t._v(t._s(i.name_long))])})],2)]),e("div",{staticClass:"form-check"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.mapDirection,expression:"mapDirection"}],staticClass:"form-check-input",attrs:{type:"radio",id:"mapDirectionInbound",value:"inbound"},domProps:{checked:t._q(t.mapDirection,"inbound")},on:{change:function(i){t.mapDirection="inbound"}}}),e("label",{staticClass:"form-check-label",attrs:{for:"mapDirectionInbound"}},[t._v("Inbound citations")])]),e("div",{staticClass:"form-check"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.mapDirection,expression:"mapDirection"}],staticClass:"form-check-input",attrs:{type:"radio",id:"mapDirectionOutbound",value:"outbound"},domProps:{checked:t._q(t.mapDirection,"outbound")},on:{change:function(i){t.mapDirection="outbound"}}}),e("label",{staticClass:"form-check-label",attrs:{for:"mapDirectionOutbound"}},[t._v("Outbound citations")])]),e("div",{attrs:{id:"hovered-map-message"}},[t.hoveredJur?e("span",[t._v(" Darker states are more likely to "+t._s(t.mapDirection==="inbound"?"cite to":"be cited by")+" "+t._s(t.hoveredJur.name_long)+". ")]):e("span",[t._v(" Hover over a state to see what other states "+t._s(t.mapDirection==="inbound"?"most often cite it":"it most often cites")+". ")])])]),e("div",{staticClass:"col-lg-9 col-md-12",attrs:{"aria-label":"United States map showing frequency of citations from one jurisdiction to another by color"}},[e("div",{attrs:{"aria-hidden":"true"}},[e("USMap",{staticClass:"map",on:{mouseover:t.mapMouseover,mouseleave:t.mapMouseleave}})],1)])]),e("h2",[t._v("Grid view")]),e("p",[t._v(" This grid shows what percentage of the citations "),e("i",[t._v("by")]),t._v(" each state on the left are "),e("i",[t._v("to")]),t._v(' each state on the top. For example, the square in the row marked "Alaska" and column marked "Cal." indicates that 2.5% of all citations extracted from Alaska cases are to California cases. '),e("a",{attrs:{href:"#",download:"cite-grid.csv"},on:{click:t.csvDownloadClicked,contextmenu:t.csvDownloadClicked}},[t._v("Download CSV")]),t._v(". ")]),e("div",[t._v(" Coloring of each square is logarithmic to emphasize the range between 0 and 10%:"),e("br"),t._v(" 0% "),e("div",{staticStyle:{display:"inline-block","background-color":"white"}},t._l(20,function(i){return e("span",{key:i,style:{backgroundColor:t.percentageColor((i-1)/2),width:"1em",display:"inline-block"},attrs:{title:(i-1)/2+"%"}},[t._v("\xA0")])}),0),t._v(" 10% ")]),e("p",[t._v(" Hover over a grid square for details: ")]),e("div",{staticClass:"table-scroll"},[t.dataLoaded?e("table",[e("tr",[e("th",{class:{"top-header":!0,"left-header":!0,disabled:t.selfDisabled},on:{click:function(i){t.selfDisabled=!t.selfDisabled}}},[t.hoveredGridMessage?e("div",{staticClass:"hovered-grid-message"},[t._v(t._s(t.hoveredGridMessage))]):t._e(),e("div",[t._v("Self")])]),t._l(t.jurisdictions,function(i){return e("th",{key:i.id,class:{rotate:!0,"top-header":!0,disabled:t.disabled[i.id]},attrs:{scope:"col"},on:{click:function(n){return t.toggleJurisdiction(i)}}},[e("div",[t._v(t._s(i.name))])])})],2),t._l(t.jurisdictions,function(i){return e("tr",{key:i.id},[e("th",{staticClass:"left-header",attrs:{scope:"row"}},[t._v(t._s(i.name))]),t._l(t.jurisdictions,function(n){return e("td",{key:n.id,style:{backgroundColor:t.countColor(i,n)},attrs:{title:t.hoverText(i,n)},on:{mouseover:function(s){t.hoveredGridMessage=t.hoverText(i,n)},mouseleave:function(s){t.hoveredGridMessage=null}}})})],2)})],2):t._e()])])])},y=[];const c=(t,o)=>t.reduce((e,i)=>(e[o(i)]=i,e),{}),l=t=>t.reduce((o,e)=>o+(e||0),0),C={name:"Main",components:{USMap:g},async mounted(){this.jurisdictions=await this.getJSON("jurisdictions.json");for(const t of this.jurisdictions)t.id=t.id.toString();this.jurisdictionsById=c(this.jurisdictions,t=>t.id),this.jurisdictionsBySlug=c(this.jurisdictions,t=>t.slug),this.jurisdictionsNotOnMap=c(this.jurisdictions.filter(t=>document.getElementById(t.slug)===null),t=>t.id),this.totals=await this.getJSON("totals.json"),this.dataLoaded=!0},data(){return{jurisdictions:null,totals:null,totalsByYear:null,selfDisabled:!1,disabled:{},dataLoaded:!1,detailJurisdiction:null,hoveredJur:null,mapDirection:"inbound",hoveredGridMessage:null}},watch:{hoveredJur:function(t){if(t){const o=t.id,e=document.getElementById(t.slug);e.style.fillOpacity=1,e.classList.add("focused");const i=this.mapDirection==="inbound"?this.inboundCounts:this.outboundCounts,n=Math.max(...i(o,this.jurisdictionsNotOnMap));for(const s of this.jurisdictions){if(s.id===o)continue;const r=this.mapDirection==="inbound"?this.totals[s.id][o]:this.totals[o][s.id],d=document.getElementById(s.slug);!d||(d.style.fillOpacity=r/n,d.classList.remove("focused"))}}}},methods:{async getJSON(t){return await _("/download/citation_graph/2020-05-08/aggregations/"+t)},citePercentage(t,o){const e=this.jurisdictionsById[t.id].cites;let i=0;return e&&(i=(this.totals[t.id][o.id]||0)/e*100),i?i.toFixed(1):0},countColor(t,o){return this.percentageColor(this.citePercentage(t,o))},percentageColor(t){return`rgba(44, 96, 255, ${this.logPercentage(t)}%)`},hoverText(t,o){let e=this.citePercentage(t,o);return`${this.jurisdictionsById[t.id].name} cites ${this.jurisdictionsById[o.id].name} ${e}%`},toggleJurisdiction(t){this.disabled[t.id]?this.$delete(this.disabled,t.id):this.$set(this.disabled,t.id,!0)},inboundCounts(t,o){return o||(o={}),Object.entries(this.totals).filter(([e,i])=>e!==t&&!o[e]&&i[t]>0).map(([e,i])=>i[t])},outboundCounts(t,o){return o||(o={}),Object.entries(this.totals[t]).filter(([e,i])=>e!==t&&!o[e]&&i>0).map(([e,i])=>i)},totalInbound(t){return l(this.inboundCounts(t))},totalOutbound(t){return l(this.outboundCounts(t))},mapMouseover(t){if(!this.dataLoaded)return;const o=t.target;o.classList.contains("state")&&(this.hoveredJur=this.jurisdictionsBySlug[o.parentElement.id])},mapMouseleave(t){},logPercentage(t){return t<.1?t:(Math.log(t)-Math.log(.1))/(Math.log(100)-Math.log(.1))*100},csvDownloadClicked(t){let o=[];o.push(["",...this.jurisdictions.map(e=>e.name_long)]);for(const e of this.jurisdictions)o.push([e.name_long,...this.jurisdictions.map(i=>this.citePercentage(e,i))]);o="data:text/csv;base64,"+btoa(f(o)),t.currentTarget.href=o}}},u={};var j=p(C,b,y,!1,k,"2788879d",null,null);function k(t){for(let o in u)this[o]=u[o]}var v=function(){return j.exports}();m(()=>import("./modulepreload-polyfill.b7f2da20.js"),[]);a.config.devtools=!0;a.config.productionTip=!1;a.use(h);const w=new h({mode:"history",base:"/exhibits/cite-grid/",routes:[{path:"/",component:v,name:"main"},{path:"*",redirect:"/"}]});new a({el:"#app",components:{Main:v},template:"<Main/>",router:w});
//# sourceMappingURL=cite-grid.2e6c6e4d.js.map
